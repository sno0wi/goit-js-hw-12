{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst form = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.load_more');\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nlet page = 1;\nlet perPage = 40;\nlet currentQuery = '';\n\nasync function searchImages(imageName) {\n    const apiKey = '41833958-d4e1402628473c9a9cbd6bb32';\n\n    const params = new URLSearchParams({\n    key: apiKey,\n    q: imageName.toLowerCase(),\n    per_page: perPage,\n    page: page,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n});\n    \n    const response = await axios.get(`/?${params}`);\n            if (response.status !== 200){\n                    throw new Error(\"No images found. Please try again with a different search query.\");\n            }\n\n            return response.data;\n}\n\nfunction renderGallery(images, append = false) {\n    const gallery = document.querySelector('.gallery');\n\n    if (!append) {\n            gallery.innerHTML = '';\n        }\n\n    if (images.hits.length === 0) {\n        iziToast.error({\n            message: \"No images found. Please try again with a different search query.\",\n        });\n        return;\n    }\n\n    const imageHTML = images.hits.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            </a>\n            <div class=\"image-details\">\n                <p>Likes </br> ${likes}</p>\n                <p>Views </br>  ${views}</p>\n                <p>Comments </br>  ${comments}</p>\n                <p>Downloads </br>  ${downloads}</p>\n            </div>\n        </li>`\n    ).join('');\n\n    gallery.innerHTML += imageHTML;\n    const lightbox = new SimpleLightbox('.gallery a');\n    lightbox.refresh();\n    \n    loadMoreBtn.style.display = 'block';\n}\n\nasync function handleSearch(event) {\n    event.preventDefault();\n\n    loadMoreBtn.style.display = 'none';\n\n    const formElement = event.currentTarget;\n    const query = formElement.elements.query.value;\n    currentQuery = query;\n\n    if (!query) {\n        iziToast.warning({\n            message: \"Please enter a search query.\",\n        });\n        return;\n    }\n\n    try {\n        const images = await searchImages(currentQuery);\n        renderGallery(images);\n        page = 1;\n    } catch (error) {\n        iziToast.error({\n            message: error.message,\n        });\n    } finally {\n        formElement.reset();\n    }\n}\n\nasync function getImages(query) {\n    try {\n        const images = await searchImages(query);\n        return images;\n    } catch (error) {\n        throw new Error(\"Error load new images.\");\n    }\n}\n\nasync function loadMore() {\n    try {\n        const images = await getImages(currentQuery);\n        page += 1;\n        renderGallery(images,true);\n    } catch (error) {\n        throw new Error(\"Error load new images.\");\n    }\n}\n\nasync function handleLoadMore() {\n\n    if (!currentQuery) {\n        iziToast.warning({\n            message: \"Please enter a search query.\",\n        });\n        return;\n    }\n\n    try {\n        await loadMore();\n    } finally {\n        // form.reset();\n    }\n}\n\nform.addEventListener('submit', handleSearch);\nloadMoreBtn.addEventListener('click', handleLoadMore);"],"names":["form","loadMoreBtn","axios","page","perPage","currentQuery","searchImages","imageName","apiKey","params","response","renderGallery","images","append","gallery","iziToast","imageHTML","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","handleSearch","event","formElement","query","error","getImages","loadMore","handleLoadMore"],"mappings":"+vBAMA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAc,SAAS,cAAc,YAAY,EAEvDC,EAAM,SAAS,QAAU,0BAEzB,IAAIC,EAAO,EACPC,EAAU,GACVC,EAAe,GAEnB,eAAeC,EAAaC,EAAW,CACnC,MAAMC,EAAS,qCAETC,EAAS,IAAI,gBAAgB,CACnC,IAAKD,EACL,EAAGD,EAAU,YAAa,EAC1B,SAAUH,EACV,KAAMD,EACN,WAAY,QACZ,YAAa,aACb,WAAY,EAChB,CAAC,EAESO,EAAW,MAAMR,EAAM,IAAI,KAAKO,CAAM,EAAE,EACtC,GAAIC,EAAS,SAAW,IAChB,MAAM,IAAI,MAAM,kEAAkE,EAG1F,OAAOA,EAAS,IAC5B,CAEA,SAASC,EAAcC,EAAQC,EAAS,GAAO,CAC3C,MAAMC,EAAU,SAAS,cAAc,UAAU,EAMjD,GAJKD,IACGC,EAAQ,UAAY,IAGxBF,EAAO,KAAK,SAAW,EAAG,CAC1BG,EAAS,MAAM,CACX,QAAS,kEACrB,CAAS,EACD,MACH,CAED,MAAMC,EAAYJ,EAAO,KAAK,IAAI,CAAC,CAAE,aAAAK,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAAK;AAAA;AAAA,4CAExEL,CAAa;AAAA,kDACPD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,iCAG3CC,CAAK;AAAA,kCACJC,CAAK;AAAA,qCACFC,CAAQ;AAAA,sCACPC,CAAS;AAAA;AAAA,cAG/C,EAAM,KAAK,EAAE,EAETT,EAAQ,WAAaE,EACJ,IAAIQ,EAAe,YAAY,EACvC,QAAO,EAEhBvB,EAAY,MAAM,QAAU,OAChC,CAEA,eAAewB,EAAaC,EAAO,CAC/BA,EAAM,eAAc,EAEpBzB,EAAY,MAAM,QAAU,OAE5B,MAAM0B,EAAcD,EAAM,cACpBE,EAAQD,EAAY,SAAS,MAAM,MAGzC,GAFAtB,EAAeuB,EAEX,CAACA,EAAO,CACRb,EAAS,QAAQ,CACb,QAAS,8BACrB,CAAS,EACD,MACH,CAED,GAAI,CACA,MAAMH,EAAS,MAAMN,EAAaD,CAAY,EAC9CM,EAAcC,CAAM,EACpBT,EAAO,CACV,OAAQ0B,EAAO,CACZd,EAAS,MAAM,CACX,QAASc,EAAM,OAC3B,CAAS,CACT,QAAc,CACNF,EAAY,MAAK,CACpB,CACL,CAEA,eAAeG,EAAUF,EAAO,CAC5B,GAAI,CAEA,OADe,MAAMtB,EAAasB,CAAK,CAE1C,MAAe,CACZ,MAAM,IAAI,MAAM,wBAAwB,CAC3C,CACL,CAEA,eAAeG,GAAW,CACtB,GAAI,CACA,MAAMnB,EAAS,MAAMkB,EAAUzB,CAAY,EAC3CF,GAAQ,EACRQ,EAAcC,EAAO,EAAI,CAC5B,MAAe,CACZ,MAAM,IAAI,MAAM,wBAAwB,CAC3C,CACL,CAEA,eAAeoB,GAAiB,CAE5B,GAAI,CAAC3B,EAAc,CACfU,EAAS,QAAQ,CACb,QAAS,8BACrB,CAAS,EACD,MACH,CAED,GAAI,CACA,MAAMgB,EAAQ,CACtB,QAAc,CAET,CACL,CAEA/B,EAAK,iBAAiB,SAAUyB,CAAY,EAC5CxB,EAAY,iBAAiB,QAAS+B,CAAc"}